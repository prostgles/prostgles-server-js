
	  
<!DOCTYPE html>
<html>
	<head>
        <title> Prostgles </title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://unpkg.com/socket.io-client@2.3.0/dist/socket.io.slim.js" type="text/javascript"></script>
        <script src="https://unpkg.com/prostgles-client@latest/dist/prostgles.js" type="text/javascript"></script>	
	</head>
	<body>
        
        <div class="wrapper"></div>
        <canvas id="canvas" width="100%" height="100%"></canvas>
		<script>
            
            const socket = io();

            prostgles({
                socket, 
                isReady: async (db, methods) => {
                    window.db = db;
                    try {

                        // db.users.subscribe({}, { select: { id: 1, posts: "*" } , limit: 2 }, items => {
                        //     let div = document.querySelector(".wrapper");
                        //     div.innerHTML = JSON.stringify(items, null, 2);
                        // });
                    } catch(e){
                        
                    }
                    // console.log(await db.users.find({}, { select: { posts: "*" } , limit: 1 }) );
                },
                onDisconnect: (err, res) => {
                    // location.reload();
                }
            });

            window.onload = function() {
                var canvas = document.getElementById('canvas');
                var ctx = canvas.getContext('2d');
                var width  = window.innerWidth;
                var height = window.innerHeight;
                canvas.height = height;
                canvas.width = width;
                canvas.addEventListener('mousedown', function(e) {
                this.down = true;  
                this.X = e.pageX ;
                this.Y = e.pageY ;
                this.color = rgb();
                }, 0);
                canvas.addEventListener('mouseup', function() {
                this.down = false;      
                }, 0);
                canvas.addEventListener('mousemove', function(e) {
                this.style.cursor = 'pointer';
                if(this.down) {
                    ctx.beginPath();
                    ctx.moveTo(this.X, this.Y);
                    ctx.lineCap = 'round';
                    ctx.lineWidth = 3;
                    ctx.lineTo(e.pageX , e.pageY );
                    ctx.strokeStyle = this.color;
                    ctx.stroke();

                    this.X = e.pageX ;
                    this.Y = e.pageY ;
                }
                }, 0);

                function rgb() {
                    color = 'rgb(';
                    for(var i = 0; i< 3; i++) {
                        color += Math.floor(Math.random() * 255)+',';
                    }
                    return color.replace(/\,$/,')');
                }    
            };
		</script>
	</body>
</html>
